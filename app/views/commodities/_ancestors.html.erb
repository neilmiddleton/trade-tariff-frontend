<nav class="commodity-ancestors"
     aria-label="A list of commodity code <%= declarable.code %>'s section, chapter and other parent commodity codes">
  <a href="#import" class="govuk-skip-link">
    Skip to information about importing commodity <%= declarable.code %>
  </a>

  <ol class="govuk-list">
    <%# list commodities section %>
    <li id="commodity-ancestors__section"
        aria-owns="commodity-ancestors__chapter">
      <%= link_to section_path(declarable.section) do %>
        <span class="commodity-ancestors__identifier">
          Section <%= declarable.section.numeral %>
        </span>

        <span class="commodity-ancestors__descriptor">
          <%= declarable.section.title %>
        </span>
      <% end %>
    </li>

    <%# list commodities chapter %>
    <li id="commodity-ancestors__chapter"
        aria-owns="commodity-ancestors__heading">
      <%= link_to chapter_path(declarable.chapter) do %>
        <span class="commodity-ancestors__identifier">
          Chapter <%= declarable.chapter.short_code %>
        </span>

        <span class="commodity-ancestors__descriptor">
          <%= declarable.chapter %>
        </span>
      <% end %>
    </li>

    <% if declarable.heading? %>

      <%# list commodities heading %>
      <li id="commodity-ancestors__heading">
        <span>
          <span class="commodity-ancestors__identifier">
            <%= segmented_commodity_code declarable.code,
                                         coloured: true %>
          </span>

          <span class="commodity-ancestors__descriptor">
            <%= sanitize declarable.description %>
          </span>
        </span>
      </li>

    <% else %>

      <%# list commodities heading %>
      <li id="commodity-ancestors__heading"
          aria-owns="<%= commodity_ancestor_id 1 %>">
        <%= link_to heading_path(declarable.heading) do %>
          <span class="commodity-ancestors__identifier">
            <%= segmented_commodity_code declarable.heading.short_code,
                                         coloured: true %>
          </span>

          <span class="commodity-ancestors__descriptor">
            <%= sanitize declarable.heading.description %>
          </span>
        <% end %>
      </li>

      <%# list each of commodities ancestors %>
      <% declarable.ancestors.each.with_index do |ancestor, index| %>
      <li id="<%= commodity_ancestor_id(index + 1) %>"
          aria-owns="<%= commodity_ancestor_id(index + 2) %>">
        <span>
          <span class="commodity-ancestors__identifier">
            <%= segmented_commodity_code abbreviate_commodity_code(ancestor), coloured: true %>
          </span>

          <span class="commodity-ancestors__descriptor">
            <%= sanitize ancestor.description %>
          </span>
        </span>
      </li>
      <% end %>

      <%# list current commodity %>
      <li id="<%= commodity_ancestor_id(declarable.ancestors.length + 1) %>">
        <span>
          <span class="commodity-ancestors__identifier">
            <%= segmented_commodity_code declarable.code,
                                         coloured: true %>
          </span>

          <span class="commodity-ancestors__descriptor">
            <%= sanitize declarable.formatted_description %>
          </span>
        </span>
      </li>

    <% end %>
  </ol>
</nav>
